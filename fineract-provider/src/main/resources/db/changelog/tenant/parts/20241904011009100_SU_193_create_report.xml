<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">

    <changeSet id="1" author="fineract">


        <insert tableName="STRETCHY_REPORT">
            <column name="REPORT_NAME" value="Informe de Liquidación de Compras de Aliados"/>
            <column name="REPORT_SQL">
                <![CDATA[
                SELECT id                                   AS "ID",
           TO_CHAR(purchase_date, 'DD/MM/YYYY') AS "Fecha de Compra",
           nit                                  AS "NIT",
           client_ally_id                       AS "ID de Aliado del Cliente",
           company_name                         AS "Nombre de la Empresa",
           point_of_sales_id                    AS "ID del Punto de Venta",
           point_of_sales_name                  AS "Nombre del Punto de Venta",
           city_id                              AS "ID de la Ciudad",
           city_name                            AS "Nombre de la Ciudad",
           buy_amount                           AS "Monto de Compra",
           settled_comission                    AS "Comisión Liquidada",
           tax_profile_id                       AS "ID del Perfil Tributario",
           loan_id                              AS "ID del Préstamo",
           client_id                            AS "ID del Cliente",
           channel_id                           AS "ID del Canal",
           settlement_status                    AS "Estado de Liquidación",
           amount_comission                     AS "Monto de la Comisión"
    FROM m_ally_purchase_settlement
    WHERE purchase_date BETWEEN '${startDate}' AND '${endDate}'
    ORDER BY purchase_date DESC

                ]]>
            </column>
            <column name="report_type" value="Table"/>
            <column name="report_category" value="Client"/>
            <column name="description" value="nforme de Liquidación de Compras de Aliados"/>
            <column name="core_report" value="false"/>
            <column name="use_report" value="true"/>
        </insert>

        <insert tableName="STRETCHY_REPORT">
            <column name="REPORT_NAME" value="Informe de Liquidación de Cobros de Aliados"/>
            <column name="REPORT_SQL">
                <![CDATA[
                SELECT id                                     AS "ID",
           TO_CHAR(collection_date, 'DD/MM/YYYY') AS "Fecha de Cobro",
           nit                                    AS "NIT",
           client_ally_id                         AS "ID de Aliado del Cliente",
           company_name                           AS "Nombre de la Empresa",
           point_of_sales_id                      AS "ID del Punto de Venta",
           point_of_sales_name                    AS "Nombre del Punto de Venta",
           city_id                                AS "ID de la Ciudad",
           city_name                              AS "Nombre de la Ciudad",
           collection_amount                      AS "Monto de Cobro",
           settled_comission                      AS "Comisión Liquidada",
           tax_profile_id                         AS "ID del Perfil Tributario",
           loan_id                                AS "ID del Préstamo",
           client_id                              AS "ID del Cliente",
           channel_id                             AS "ID del Canal"
    FROM m_ally_collection_settlement
    WHERE collection_date BETWEEN  '${startDate}' AND '${endDate}'
                ORDER BY collection_date DESC
                ]]>
            </column>
            <column name="report_type" value="Table"/>
            <column name="report_category" value="Client"/>
            <column name="description" value="Informe de Liquidación de Cobros de Aliados"/>
            <column name="core_report" value="false"/>
            <column name="use_report" value="true"/>
        </insert>

        <insert tableName="stretchy_report_parameter">
            <column name="report_id"
                    valueComputed="(select id from stretchy_report where report_name = 'Informe de Liquidación de Cobros de Aliados')"/>
            <column name="parameter_id"
                    valueComputed="(select id from stretchy_parameter where parameter_variable  = 'startDate')"/>
            <column name="report_parameter_name" value="startDate"/>
            <column name="mandatory_parameter" value="true"/>
        </insert>
        <insert tableName="stretchy_report_parameter">
            <column name="report_id"
                    valueComputed="(select id from stretchy_report where report_name = 'Informe de Liquidación de Cobros de Aliados')"/>
            <column name="parameter_id"
                    valueComputed="(select id from stretchy_parameter where parameter_variable  = 'endDate')"/>
            <column name="report_parameter_name" value="endDate"/>
            <column name="mandatory_parameter" value="true"/>
        </insert>
        <insert tableName="stretchy_report_parameter">
            <column name="report_id"
                    valueComputed="(select id from stretchy_report where report_name = 'Informe de Liquidación de Compras de Aliados')"/>
            <column name="parameter_id"
                    valueComputed="(select id from stretchy_parameter where parameter_variable  = 'startDate')"/>
            <column name="report_parameter_name" value="startDate"/>
            <column name="mandatory_parameter" value="true"/>
        </insert>
        <insert tableName="stretchy_report_parameter">
            <column name="report_id"
                    valueComputed="(select id from stretchy_report where report_name = 'Informe de Liquidación de Compras de Aliados')"/>
            <column name="parameter_id"
                    valueComputed="(select id from stretchy_parameter where parameter_variable  = 'endDate')"/>
            <column name="report_parameter_name" value="endDate"/>
            <column name="mandatory_parameter" value="true"/>
        </insert>


    </changeSet>


</databaseChangeLog>
